---
title: tezx/profiler
description: Lightweight, extensible profiling middleware for TezX framework supporting Node.js, Bun, and Deno.
---

# ðŸ“¦ @tezx/profiler

A lightweight, extensible profiling middleware for the [TezX](https://www.npmjs.com/package/tezx) framework.  
Track runtime performance, memory usage, CPU stats, with plugin support and rotating file storage.

---

## Features

- â±ï¸ Measure route execution time
- ðŸ’¾ Monitor memory usage in MB
- âš™ï¸ Capture CPU usage in milliseconds
- ðŸ“Š System stats endpoint (`/__profiler`) with a clean UI
- ðŸ”Œ Plugin hooks (`beforeProfile`, `afterProfile`)
- ðŸ“ Rotating file storage for logs
- âœ… Written in TypeScript with full type safety

---

## Installation

```bash
npm install @tezx/profiler
# or
yarn add @tezx/profiler
# or
bun add @tezx/profiler
````

---

## Usage Example

### Basic Setup

```ts
import { TezX } from 'tezx';
import { profiler, createRotatingFileStorage } from '@tezx/profiler';

const app = new TezX();

app.use(
  profiler({
    route: '/__profiler',
    excludePaths: ['/favicon.ico'],
    metrics: ['time', 'memory', 'cpu'],
    storage: createRotatingFileStorage('./profiler.log', 1024 * 1024), // Rotate every 1MB
    plugins: [],
  })
);

app.get('/', (ctx) => ctx.json({ message: 'Hello World' }));
```

---

## Profiler UI

Visit:

```bash
http://localhost:3000/__profiler
```

Displays:

* âœ… Uptime (seconds)
* âœ… Timestamp
* âœ… Memory Usage (`rss`, `heapTotal`, `heapUsed`, etc.) in MB
* âœ… CPU Usage (`user`, `system`) in ms

---

## âš™ï¸ Profiler Options

| Option         | Type                              | Default             | Description                   |
| -------------- | --------------------------------- | ------------------- | ----------------------------- |
| `route`        | `string`                          | `/__profiler`       | Path to view system stats     |
| `excludePaths` | `string[]`                        | `[]`                | Paths to ignore               |
| `metrics`      | `("time" \| "memory" \| "cpu")[]` | `['time','memory']` | Metrics to collect            |
| `storage`      | `StorageAdapter`                  | `undefined`         | Save profile results          |
| `plugins`      | `ProfilerPlugin[]`                | `[]`                | Hook into profiling lifecycle |

---

## Plugins Example

```ts
const myPlugin = {
  beforeProfile: () => console.log('Starting profiling...'),
  afterProfile: (result) => console.log('Profile completed:', result),
};

app.use(profiler({ plugins: [myPlugin] }));
```

---

## Rotating File Storage Example

```ts
const storage = createRotatingFileStorage('./profiler.log', 1024 * 1024); // 1MB rotation
app.use(profiler({ storage }));
```


---

## Example Profile Output

```json
{
  "name": "default",
  "duration": 6.25,
  "timestamp": "2025-07-06T19:25:47.753Z",
  "method": "GET",
  "path": "/",
  "memoryUsage": {
    "rss": 10485760,
    "heapTotal": 6291456,
    "heapUsed": 4194304,
    "external": 102400,
    "arrayBuffers": 51200
  },
  "cpuUsage": {
    "user": 1416,
    "system": 312
  }
}
```

---

## System Stats Breakdown

### Memory Usage

* `rss`: Resident Set Size (total memory allocated for the process)
* `heapTotal`: Total allocated heap size
* `heapUsed`: Heap actually used
* `external`: Memory used by C++ objects bound to JS
* `arrayBuffers`: Memory allocated for ArrayBuffer

### CPU Usage

* `user`: Time spent in user mode (Î¼s)
* `system`: Time spent in kernel mode (Î¼s)

---