
# ðŸ”€ **Router Merging â€” TezX**

## ðŸ“˜ Overview

**Router merging** enables seamless integration of multiple routers into a parent application, preserving route hierarchy and avoiding accidental collisions by design.

---

## ðŸ§­ Terminology

| Term              | Meaning                                                     |
| ----------------- | ----------------------------------------------------------- |
| **Parent Router** | Your primary app instance (`TezX` or `Router`)              |
| **Sub-Router**    | A child router with its own routes and middleware           |
| **Merged Router** | The resulting router structure after `.use()` or `.merge()` |

---

## ðŸ“‚ Pre-Merge Example

```bash
Parent Router:
â”œâ”€â”€ /test
â”‚   â”œâ”€â”€ GET â†’ handler1
â”‚   â””â”€â”€ /1
â”‚       â”œâ”€â”€ GET â†’ handler2
```

---

## âž• Adding a Sub-Router

```bash
Sub-Router:
â”œâ”€â”€ /products
â”‚   â””â”€â”€ /2
â”‚       â”œâ”€â”€ GET â†’ handler3
```

---

## âœ… After Merge

```bash
Merged Router:
â”œâ”€â”€ /test
â”‚   â”œâ”€â”€ GET â†’ handler1
â”‚   â””â”€â”€ /1
â”‚       â”œâ”€â”€ GET â†’ handler2
â”œâ”€â”€ /products
â”‚   â””â”€â”€ /2
â”‚       â”œâ”€â”€ GET â†’ handler3
```

> âœ… All routes remain intact and merge **non-destructively**.

---

## ðŸ§ª Code Example

```ts
import { TezX, Router } from "tezx";

// Parent router
const app = new TezX();
app.get("/test", (ctx) => ctx.text("Handler 1"));
app.get("/test/1", (ctx) => ctx.text("Handler 2"));

// Sub-router
const productRouter = new Router();
productRouter.get("/products/2", (ctx) => ctx.text("Handler 3"));

// Merge the routers
app.use("/", productRouter);
```

---

## ðŸ§‘â€ðŸ’» Best Practices

### 1. **Use Unique Prefixes**

Avoid route conflicts by assigning distinct prefixes:

```ts
const authRouter = new Router();
authRouter.get("/login", ...);
app.use("/auth", authRouter); // Routes like /auth/login
```

---

### 2. **Middleware Hygiene**

Each sub-router can register its own middleware chain:

```ts
const api = new Router();

api.use((ctx, next) => {
  ctx.setHeader("x-api", "v1");
  return next();
});

api.get("/status", (ctx) => ctx.json({ ok: true }));

app.use("/api", api);
```

---

### 3. **Inspect Route Tree**

Use dev logs to inspect routes:

```ts
console.log(app.routes); // Tree-style structure if exposed
```

---

### 4. **Safe Re-Merge Patterns**

Avoid defining the same path in multiple routers unless intended.

```ts
// Avoid this
router1.get("/ping", ...);
router2.get("/ping", ...);

// Instead, use a prefix
app.use("/api", router1);
app.use("/public", router2);
```

---

## ðŸ” Debug Tip

```ts
app.get("/example", (ctx) => {
  console.log("Routing to /example");
  return ctx.text("Logged");
});
```
